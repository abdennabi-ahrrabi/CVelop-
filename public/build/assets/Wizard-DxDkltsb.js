import{r as n,j as e,b as U,H as X,L as Z}from"./app-BWfocxdu.js";import{A as ee}from"./AuthenticatedLayout-BlGNKwXn.js";import{t as te,b as v}from"./api-DWuNZLhI.js";import"./transition-CkejyAL4.js";function re(){const[L,_]=n.useState("welcome"),[i,y]=n.useState(null),[b,j]=n.useState({}),[f,N]=n.useState(""),[S,M]=n.useState([]),[p,m]=n.useState(!1),[w,A]=n.useState(!1),[V,D]=n.useState([]),[c,F]=n.useState([]),[u,I]=n.useState([]),[s,h]=n.useState({company:"",position:"",description:"",start_date:"",end_date:"",is_current:!1}),[o,d]=n.useState({institution:"",degree:"",field:"",description:"",start_date:"",end_date:"",is_current:!1}),[z,k]=n.useState(!1),[B,C]=n.useState(!1),W=n.useRef(null);n.useEffect(()=>{R("welcome"),H()},[]),n.useEffect(()=>{$()},[S]);const $=()=>{W.current?.scrollIntoView({behavior:"smooth"})},H=async()=>{try{const t=await te.getAll();D(t.data.data||t.data||[])}catch(t){console.error("Failed to load templates:",t)}},R=async t=>{m(!0);try{const a=(await v.getStep(t,b)).data.data;y(a),_(t),l("bot",a.question),a.type==="work_form"?k(!0):a.type==="education_form"&&C(!0)}catch(r){console.error("Failed to load step:",r)}finally{m(!1)}},l=(t,r,a=null)=>{M(x=>[...x,{sender:t,text:r,data:a,timestamp:new Date}])},P=async t=>{if(t?.preventDefault(),i?.type==="work_form"||i?.type==="education_form"||!f.trim()&&i?.required)return;const r=f.trim();l("user",r||"(skipped)"),N(""),await g(r)},T=async t=>{l("user",t.label),await g(t.value)},q=async t=>{l("user",`Selected: ${t.name}`),await g(t.id)},g=async t=>{m(!0);try{const r={...b};i?.field&&(r[i.field]=t),r.work_experiences=c,r.educations=u,j(r);const a=await v.processInput(L,t,r);if(a.data.done)l("bot","Your CV is ready! Click the button below to create it."),y({type:"complete",done:!0}),j(a.data.data);else if(a.data.nextStep){const x=a.data.nextStep;y(x),_(x.step),j(a.data.data),l("bot",x.question),x.type==="work_form"?k(!0):x.type==="education_form"&&C(!0)}}catch(r){console.error("Failed to process step:",r),l("bot","Sorry, something went wrong. Please try again.")}finally{m(!1)}},E=async(t,r)=>{if(!t.trim())return t;A(!0);try{return(await v.enhance(t,r,b.cv_type)).data.enhanced||t}catch(a){return console.error("Failed to enhance:",a),t}finally{A(!1)}},Y=async()=>{if(!s.company||!s.position){alert("Please fill in at least the company and position");return}let t=s.description;s.description.trim()&&(t=await E(s.description,"work"));const r={...s,description:t};F([...c,r]),l("user",`Added: ${r.position} at ${r.company}`),h({company:"",position:"",description:"",start_date:"",end_date:"",is_current:!1})},G=()=>{k(!1);const t=c.length;l("bot",t>0?`Great! Added ${t} work experience(s).`:"No work experience added."),g(c)},O=async()=>{if(!o.institution||!o.degree){alert("Please fill in at least the institution and degree");return}let t=o.description;o.description.trim()&&(t=await E(o.description,"education"));const r={...o,description:t};I([...u,r]),l("user",`Added: ${r.degree} from ${r.institution}`),d({institution:"",degree:"",field:"",description:"",start_date:"",end_date:"",is_current:!1})},J=()=>{C(!1);const t=u.length;l("bot",t>0?`Perfect! Added ${t} education entry(ies).`:"No education added."),g(u)},K=async()=>{m(!0);try{const t={...b,work_experiences:c,educations:u},r=await v.createResume(t);r.data.success&&(l("bot","Your CV has been created successfully! Redirecting to editor..."),setTimeout(()=>{U.visit(`/resumes/${r.data.resume.id}/edit`)},1500))}catch(t){console.error("Failed to create resume:",t),l("bot","Failed to create CV. Please try again.")}finally{m(!1)}},Q=()=>i?i.type==="complete"?e.jsx("div",{className:"p-4 bg-gradient-to-r from-emerald-500/10 to-green-500/10 rounded-xl border border-emerald-500/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center shadow-lg shadow-emerald-500/25",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"CV Ready!"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Your information has been collected. Click below to create your CV."}),e.jsx("button",{onClick:K,disabled:p,className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-600 to-green-600 text-white font-semibold rounded-xl hover:from-emerald-500 hover:to-green-500 transition-all shadow-lg shadow-emerald-500/25 disabled:opacity-50",children:p?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create My CV"]})})]})}):i.type==="select"?e.jsx("div",{className:"grid grid-cols-2 gap-3 p-4",children:i.options?.map(t=>e.jsx("button",{onClick:()=>T(t),disabled:p,className:"p-4 text-left bg-white/5 border border-white/10 rounded-xl hover:border-violet-500/50 hover:bg-violet-500/10 transition-all",children:e.jsx("span",{className:"font-medium text-white",children:t.label})},t.value))}):i.type==="template_select"?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 p-4",children:V.map(t=>e.jsxs("button",{onClick:()=>q(t),disabled:p,className:"p-4 text-center bg-white/5 border border-white/10 rounded-xl hover:border-violet-500/50 hover:bg-violet-500/10 transition-all",children:[e.jsx("div",{className:"w-full h-24 bg-white/5 rounded-lg mb-2 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("span",{className:"font-medium text-white",children:t.name})]},t.id))}):i.type==="work_form"&&z?e.jsxs("div",{className:"p-4 space-y-4 bg-white/5 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Company *",value:s.company,onChange:t=>h({...s,company:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"text",placeholder:"Position *",value:s.position,onChange:t=>h({...s,position:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"date",placeholder:"Start Date",value:s.start_date,onChange:t=>h({...s,start_date:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"date",placeholder:"End Date",value:s.end_date,onChange:t=>h({...s,end_date:t.target.value}),disabled:s.is_current,className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-violet-500 disabled:opacity-50"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:s.is_current,onChange:t=>h({...s,is_current:t.target.checked,end_date:""}),className:"rounded border-white/20 bg-white/5 text-violet-500 focus:ring-violet-500"}),"I currently work here"]}),e.jsx("textarea",{placeholder:"Describe your responsibilities (AI will enhance it!)",value:s.description,onChange:t=>h({...s,description:t.target.value}),rows:"3",className:"w-full px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 resize-none"}),c.length>0&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Added: ",c.map(t=>t.position).join(", ")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:Y,disabled:w,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-violet-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-violet-500 hover:to-indigo-500 disabled:opacity-50 transition-all",children:w?"Enhancing...":"Add Experience"}),e.jsx("button",{type:"button",onClick:G,className:"px-4 py-2.5 bg-white/5 border border-white/10 text-gray-300 font-medium rounded-xl hover:bg-white/10 transition-all",children:"Done"})]})]}):i.type==="education_form"&&B?e.jsxs("div",{className:"p-4 space-y-4 bg-white/5 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Institution *",value:o.institution,onChange:t=>d({...o,institution:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"text",placeholder:"Degree *",value:o.degree,onChange:t=>d({...o,degree:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"text",placeholder:"Field of Study",value:o.field,onChange:t=>d({...o,field:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"date",placeholder:"Start Date",value:o.start_date,onChange:t=>d({...o,start_date:t.target.value}),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("input",{type:"date",placeholder:"End Date",value:o.end_date,onChange:t=>d({...o,end_date:t.target.value}),disabled:o.is_current,className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-violet-500 disabled:opacity-50"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:o.is_current,onChange:t=>d({...o,is_current:t.target.checked,end_date:""}),className:"rounded border-white/20 bg-white/5 text-violet-500 focus:ring-violet-500"}),"I currently study here"]}),e.jsx("textarea",{placeholder:"Describe achievements or activities (optional)",value:o.description,onChange:t=>d({...o,description:t.target.value}),rows:"2",className:"w-full px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 resize-none"}),u.length>0&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Added: ",u.map(t=>t.degree).join(", ")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:O,disabled:w,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-violet-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-violet-500 hover:to-indigo-500 disabled:opacity-50 transition-all",children:w?"Enhancing...":"Add Education"}),e.jsx("button",{type:"button",onClick:J,className:"px-4 py-2.5 bg-white/5 border border-white/10 text-gray-300 font-medium rounded-xl hover:bg-white/10 transition-all",children:"Done"})]})]}):e.jsxs("form",{onSubmit:P,className:"p-4",children:[e.jsxs("div",{className:"flex gap-2",children:[i.type==="textarea"?e.jsx("textarea",{value:f,onChange:t=>N(t.target.value),placeholder:i.placeholder,rows:"3",className:"flex-1 px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 resize-none"}):e.jsx("input",{type:i.type||"text",value:f,onChange:t=>N(t.target.value),placeholder:i.placeholder,className:"flex-1 px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500"}),e.jsx("button",{type:"submit",disabled:p||i.required&&!f.trim(),className:"px-4 py-2.5 bg-gradient-to-r from-violet-600 to-indigo-600 text-white rounded-xl hover:from-violet-500 hover:to-indigo-500 disabled:opacity-50 transition-all",children:p?e.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})]}),!i.required&&e.jsx("button",{type:"button",onClick:()=>g(""),className:"mt-2 text-sm text-gray-500 hover:text-gray-300 transition-colors",children:"Skip this step"})]}):null;return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-200px)] max-w-3xl mx-auto rounded-2xl bg-white/5 backdrop-blur-xl border border-white/10 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-violet-600 to-indigo-600 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"AI CV Wizard"}),e.jsx("p",{className:"text-sm text-violet-100",children:"Let me help you create your perfect CV"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[S.map((t,r)=>e.jsx("div",{className:`flex ${t.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] px-4 py-3 rounded-2xl ${t.sender==="user"?"bg-gradient-to-r from-violet-600 to-indigo-600 text-white rounded-br-md":"bg-white/10 text-white rounded-bl-md border border-white/10"}`,children:[t.sender==="bot"&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-4 h-4 text-violet-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("span",{className:"text-xs font-medium text-violet-400",children:"AI Assistant"})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.text})]})},r)),e.jsx("div",{ref:W})]}),e.jsx("div",{className:"border-t border-white/10",children:Q()})]})}function ae(){return e.jsxs(ee,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-violet-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-violet-500/25",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold leading-tight text-white",children:"AI CV Wizard"}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Let AI guide you through creating your perfect CV"})]})]}),e.jsxs(Z,{href:route("resumes.index"),className:"inline-flex items-center gap-2 rounded-xl bg-white/5 border border-white/10 px-4 py-2.5 text-sm font-semibold text-gray-300 hover:bg-white/10 hover:text-white transition-all",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Resumes"]})]}),children:[e.jsx(X,{title:"AI CV Wizard"}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx(re,{})})})]})}export{ae as default};
